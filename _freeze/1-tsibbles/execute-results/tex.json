{
  "hash": "4852e90ce8110a45b8299f0e36bc7ce9",
  "result": {
    "markdown": "---\ntitle: \"Time Series Analysis & Forecasting Using R\"\nsubtitle: \"1. Introduction to tsibbles\"\n---\n\n\n## Outline\n\n\\vspace*{0.7cm}\\tableofcontents\n\n\n\n\n\n# Time series data and tsibbles\n\n## Tidyverts packages\n\n\\begin{textblock}{4.2}(8,0)\\begin{alertblock}{}\\Large\\textbf{tidyverts.org}\\end{alertblock}\\end{textblock}\n\n\\placefig{1}{1.4}{width=3.5cm}{tsibble.png}\n\\placefig{5}{1.4}{width=3.5cm}{tsibbledata.png}\n\\placefig{3}{4.85}{width=3.5cm}{feasts.png}\n\\placefig{7}{4.85}{width=3.5cm}{fable.png}\n\n## Tidyverts developers\n\n\\begin{textblock}{5.7}(0.4,1.4)\n\\begin{block}{Earo Wang}\n\\includegraphics[height=5.8cm]{earowang}\n\\end{block}\n\\end{textblock}\n\n\\begin{textblock}{5.7}(6.75,1.4)\n\\begin{block}{Mitchell O'Hara-Wild}\n\\includegraphics[height=5.8cm]{mitch}\n\\end{block}\n\\end{textblock}\n\n## Time series data\n\n  - Four-yearly Olympic winning times\n  - Annual Google profits\n  - Quarterly Australian beer production\n  - Monthly rainfall\n  - Weekly retail sales\n  - Daily IBM stock prices\n  - Hourly electricity demand\n  - 5-minute freeway traffic counts\n  - Time-stamped stock transaction data\n\n## Class packages\n\\fontsize{13}{14}\\sf\n\n```r\n# Data manipulation\nlibrary(dplyr)\n# Plotting functions\nlibrary(ggplot2)\n# Time and date manipulation\nlibrary(lubridate)\n# Time series class\nlibrary(tsibble)\n# Tidy time series data\nlibrary(tsibbledata)\n# Time series graphics and statistics\nlibrary(feasts)\n# Forecasting functions\nlibrary(fable)\n```\n\n\\pause\n\n```r\n# All of the above\nlibrary(fpp3)\n```\n\n\n\n## `tsibble` objects\n\n\\fontsize{10}{11.2}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/unnamed-chunk-2_0ab2cb67c32ff911654f55b37145e21c'}\n\n```{.r .cell-code}\nglobal_economy\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tsibble: 15,150 x 6 [1Y]\n# Key:       Country [263]\n    Year Country             GDP Imports Exports Population\n   <dbl> <fct>             <dbl>   <dbl>   <dbl>      <dbl>\n 1  1960 Afghanistan  537777811.    7.02    4.13    8996351\n 2  1961 Afghanistan  548888896.    8.10    4.45    9166764\n 3  1962 Afghanistan  546666678.    9.35    4.88    9345868\n 4  1963 Afghanistan  751111191.   16.9     9.17    9533954\n 5  1964 Afghanistan  800000044.   18.1     8.89    9731361\n 6  1965 Afghanistan 1006666638.   21.4    11.3     9938414\n 7  1966 Afghanistan 1399999967.   18.6     8.57   10152331\n 8  1967 Afghanistan 1673333418.   14.2     6.77   10372630\n 9  1968 Afghanistan 1373333367.   15.2     8.90   10604346\n10  1969 Afghanistan 1408888922.   15.0    10.1    10854428\n# i 15,140 more rows\n```\n:::\n:::\n\n\n\\only<2->{\\begin{textblock}{.75}(1.65,3.2)\n\\begin{alertblock}{}\\fontsize{10}{10}\\sf Index\\phantom{dg}\\end{alertblock}\n\\end{textblock}}\n\\only<3->{\\begin{textblock}{1.6}(2.72,3.2)\n\\begin{alertblock}{}\\fontsize{10}{10}\\sf Key\\phantom{dg}\\end{alertblock}\n\\end{textblock}}\n\\only<4>{\\begin{textblock}{6.3}(5.2,3.2)\n\\begin{alertblock}{}\\fontsize{10}{10}\\sf Measured variables\\phantom{dg}\\end{alertblock}\n\\end{textblock}}\n\n## `tsibble` objects\n\n\\fontsize{10}{11.2}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/unnamed-chunk-3_9331d91164c7d61366409c263e7b0f94'}\n\n```{.r .cell-code}\ntourism\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tsibble: 24,320 x 5 [1Q]\n# Key:       Region, State, Purpose [304]\n   Quarter Region   State Purpose  Trips\n     <qtr> <chr>    <chr> <chr>    <dbl>\n 1 1998 Q1 Adelaide SA    Business  135.\n 2 1998 Q2 Adelaide SA    Business  110.\n 3 1998 Q3 Adelaide SA    Business  166.\n 4 1998 Q4 Adelaide SA    Business  127.\n 5 1999 Q1 Adelaide SA    Business  137.\n 6 1999 Q2 Adelaide SA    Business  200.\n 7 1999 Q3 Adelaide SA    Business  169.\n 8 1999 Q4 Adelaide SA    Business  134.\n 9 2000 Q1 Adelaide SA    Business  154.\n10 2000 Q2 Adelaide SA    Business  169.\n# i 24,310 more rows\n```\n:::\n:::\n\n\n\\only<2->{\\begin{textblock}{1.1}(1.6,3.13)\n\\begin{alertblock}{}\\fontsize{10}{10}\\sf Index\\phantom{dg}\\end{alertblock}\n\\end{textblock}}\n\\only<3->{\\begin{textblock}{3.8}(3.05,3.13)\n\\begin{alertblock}{}\\fontsize{10}{10}\\sf Keys\\phantom{dg}\\end{alertblock}\n\\end{textblock}}\n\\only<4>{\\begin{textblock}{1.5}(7.15,3.13)\n\\begin{alertblock}{}\\fontsize{10}{10}\\sf Measure\\phantom{dg}\\end{alertblock}\n\\end{textblock}}\n\n\\begin{textblock}{3}(9,5)\n\\begin{block}{}\\fontsize{10}{10}\\sf Domestic visitor nights in thousands by state/region and purpose.\\phantom{dg}\\end{block}\n\\end{textblock}\n\n## `tsibble` objects\n\n* A `tsibble` allows storage and manipulation of multiple time series in R.\n\n* It contains:\n\n  + An index: time information about the observation\n  + Measured variable(s): numbers of interest\n  + Key variable(s): optional unique identifiers for each series\n\n* It works with tidyverse functions.\n\n## The `tsibble` index\n\n### Example\n\\fontsize{11}{12}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/tstable_d8df8f293adfcfec51e709ff3722a9e2'}\n\n```{.r .cell-code}\nmydata <- tsibble(\n  year = 2012:2016,\n  y = c(123, 39, 78, 52, 110),\n  index = year\n)\nmydata\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tsibble: 5 x 2 [1Y]\n   year     y\n  <int> <dbl>\n1  2012   123\n2  2013    39\n3  2014    78\n4  2015    52\n5  2016   110\n```\n:::\n:::\n\n\n## The `tsibble` index\n\n\\begin{block}{}\nFor observations more frequent than once per year, we need to use a time class function on the index.\n\\end{block}\n\\fontsize{12}{13}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/tstablemonth_ba3d1edc3e467150cc465a02efabe2bd'}\n\n:::\n\n::: {.cell hash='1-tsibbles_cache/beamer/tstablemonth2_441faf0e8ad96d64df129c229eb36bf0'}\n\n```{.r .cell-code}\nz\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 x 2\n  Month    Observation\n  <chr>          <dbl>\n1 2019 Jan          50\n2 2019 Feb          23\n3 2019 Mar          34\n4 2019 Apr          30\n5 2019 May          25\n```\n:::\n:::\n\n\n\\vspace*{10cm}\n\n## The `tsibble` index\n\n\\begin{block}{}\nFor observations more frequent than once per year, we need to use a time class function on the index.\n\\end{block}\n\\fontsize{12}{13}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/month-tsibble_98938c09d7202734b2d1d83802856764'}\n\n```{.r .cell-code}\nz |>\n  mutate(Month = yearmonth(Month)) |>\n  as_tsibble(index = Month)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tsibble: 5 x 2 [1M]\n     Month Observation\n     <mth>       <dbl>\n1 2019 Jan          50\n2 2019 Feb          23\n3 2019 Mar          34\n4 2019 Apr          30\n5 2019 May          25\n```\n:::\n:::\n\n\n\\vspace*{10cm}\n\n## The `tsibble` index\n\\vspace*{-0.2cm}\n\nCommon time index variables can be created with these functions:\n\n###\n\n::: {.cell hash='1-tsibbles_cache/beamer/tstable2_208bab8e1ada4a58babea97c9f6f5c04'}\n::: {.cell-output-display}\n|Frequency |Function             |\n|:---------|:--------------------|\n|Annual    |`start:end`          |\n|Quarterly |`yearquarter()`      |\n|Monthly   |`yearmonth()`        |\n|Weekly    |`yearweek()`         |\n|Daily     |`as_date()`, `ymd()` |\n|Sub-daily |`as_datetime()`      |\n:::\n:::\n\n\n# Example: Australian prison population\n\n## Australian prison population\n\n\\full{Beechworth_prison}\n\n## Read a csv file and convert to a tsibble {-}\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/prison_7e8876027b734866f17e0bf369931088'}\n\n```{.r .cell-code}\nprison <- readr::read_csv(\"data/prison_population.csv\")\n```\n:::\n\n::: {.cell hash='1-tsibbles_cache/beamer/prison2a_b62867d6498c307f4a7e2cb50504d3a1'}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3,072 x 6\n   date       state gender legal     indigenous count\n   <date>     <chr> <chr>  <chr>     <chr>      <dbl>\n 1 2005-03-01 ACT   Female Remanded  ATSI           0\n 2 2005-03-01 ACT   Female Remanded  Other          2\n 3 2005-03-01 ACT   Female Sentenced ATSI           0\n 4 2005-03-01 ACT   Female Sentenced Other          0\n 5 2005-03-01 ACT   Male   Remanded  ATSI           7\n 6 2005-03-01 ACT   Male   Remanded  Other         58\n 7 2005-03-01 ACT   Male   Sentenced ATSI           0\n 8 2005-03-01 ACT   Male   Sentenced Other          0\n 9 2005-03-01 NSW   Female Remanded  ATSI          51\n10 2005-03-01 NSW   Female Remanded  Other        131\n# i 3,062 more rows\n```\n:::\n:::\n\n## Read a csv file and convert to a tsibble {-}\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/prison3_0f46493e449123777bc87f807622cd43'}\n\n```{.r .cell-code}\nprison <- readr::read_csv(\"data/prison_population.csv\") |>\n  mutate(Quarter = yearquarter(date))\n```\n:::\n\n::: {.cell hash='1-tsibbles_cache/beamer/prison3a_6c8affcb209c0f83570071a1ff1b58eb'}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3,072 x 7\n   date       state gender legal     indigenous count Quarter\n   <date>     <chr> <chr>  <chr>     <chr>      <dbl>   <qtr>\n 1 2005-03-01 ACT   Female Remanded  ATSI           0 2005 Q1\n 2 2005-03-01 ACT   Female Remanded  Other          2 2005 Q1\n 3 2005-03-01 ACT   Female Sentenced ATSI           0 2005 Q1\n 4 2005-03-01 ACT   Female Sentenced Other          0 2005 Q1\n 5 2005-03-01 ACT   Male   Remanded  ATSI           7 2005 Q1\n 6 2005-03-01 ACT   Male   Remanded  Other         58 2005 Q1\n 7 2005-03-01 ACT   Male   Sentenced ATSI           0 2005 Q1\n 8 2005-03-01 ACT   Male   Sentenced Other          0 2005 Q1\n 9 2005-03-01 NSW   Female Remanded  ATSI          51 2005 Q1\n10 2005-03-01 NSW   Female Remanded  Other        131 2005 Q1\n# i 3,062 more rows\n```\n:::\n:::\n\n\n## Read a csv file and convert to a tsibble {-}\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/prison4_4ec75d96772cbb30fcb7400287f6d97f'}\n\n```{.r .cell-code}\nprison <- readr::read_csv(\"data/prison_population.csv\") |>\n  mutate(Quarter = yearquarter(date)) |>\n  select(-date)\n```\n:::\n\n::: {.cell hash='1-tsibbles_cache/beamer/prison4a_d69d8ab0460d4cb4616aa40f560df291'}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3,072 x 6\n   state gender legal     indigenous count Quarter\n   <chr> <chr>  <chr>     <chr>      <dbl>   <qtr>\n 1 ACT   Female Remanded  ATSI           0 2005 Q1\n 2 ACT   Female Remanded  Other          2 2005 Q1\n 3 ACT   Female Sentenced ATSI           0 2005 Q1\n 4 ACT   Female Sentenced Other          0 2005 Q1\n 5 ACT   Male   Remanded  ATSI           7 2005 Q1\n 6 ACT   Male   Remanded  Other         58 2005 Q1\n 7 ACT   Male   Sentenced ATSI           0 2005 Q1\n 8 ACT   Male   Sentenced Other          0 2005 Q1\n 9 NSW   Female Remanded  ATSI          51 2005 Q1\n10 NSW   Female Remanded  Other        131 2005 Q1\n# i 3,062 more rows\n```\n:::\n:::\n\n\n## Read a csv file and convert to a tsibble {-}\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/prison5_982b665baa72e04c58a33daa98997c7e'}\n\n```{.r .cell-code}\nprison <- readr::read_csv(\"data/prison_population.csv\") |>\n  mutate(Quarter = yearquarter(date)) |>\n  select(-date) |>\n  as_tsibble(\n    index = Quarter,\n    key = c(state, gender, legal, indigenous)\n  )\n```\n:::\n\n::: {.cell hash='1-tsibbles_cache/beamer/prison5a_e9da2a2cedb656d87bec3ff287bf0501'}\n::: {.cell-output .cell-output-stdout}\n```\n# A tsibble: 3,072 x 6 [1Q]\n# Key:       state, gender, legal, indigenous [64]\n   state gender legal    indigenous count Quarter\n   <chr> <chr>  <chr>    <chr>      <dbl>   <qtr>\n 1 ACT   Female Remanded ATSI           0 2005 Q1\n 2 ACT   Female Remanded ATSI           1 2005 Q2\n 3 ACT   Female Remanded ATSI           0 2005 Q3\n 4 ACT   Female Remanded ATSI           0 2005 Q4\n 5 ACT   Female Remanded ATSI           1 2006 Q1\n 6 ACT   Female Remanded ATSI           1 2006 Q2\n 7 ACT   Female Remanded ATSI           1 2006 Q3\n 8 ACT   Female Remanded ATSI           0 2006 Q4\n 9 ACT   Female Remanded ATSI           0 2007 Q1\n10 ACT   Female Remanded ATSI           1 2007 Q2\n# i 3,062 more rows\n```\n:::\n:::\n\n\n# Example: Australian pharmaceutical sales\n\n## Australian Pharmaceutical Benefits Scheme\n\n\\full{pills}\n\n## Australian Pharmaceutical Benefits Scheme\n\\begin{block}{}\nThe \\alert{Pharmaceutical Benefits Scheme} (PBS) is the Australian government drugs subsidy scheme.\n\\end{block}\n\\pause\\fontsize{13.3}{15}\\sf\n\n  * Many drugs bought from pharmacies are subsidised to allow more equitable access to modern drugs.\n  * The cost to government is determined by the number and types of drugs purchased. Currently nearly 1\\% of GDP.\n  * The total cost is budgeted based on forecasts of drug usage.\n  * Costs are disaggregated by drug type (ATC1 x15 / ATC2 84), concession category (x2) and patient type (x2), giving $84\\times2\\times2=336$ time series.\n\n## Working with `tsibble` objects {-}\n\\fontsize{8}{10}\\sf\n\n\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/pbs1_58d7fba2116615fc405062f7317ab494'}\n\n```{.r .cell-code}\nPBS\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tsibble: 67,596 x 9 [1M]\n# Key:       Concession, Type, ATC1, ATC2 [336]\n      Month Concession   Type    ATC1  ATC1_desc ATC2  ATC2_desc Scripts  Cost\n      <mth> <chr>        <chr>   <chr> <chr>     <chr> <chr>       <dbl> <dbl>\n 1 1991 Jul Concessional Co-pay~ A     Alimenta~ A01   STOMATOL~   18228 67877\n 2 1991 Aug Concessional Co-pay~ A     Alimenta~ A01   STOMATOL~   15327 57011\n 3 1991 Sep Concessional Co-pay~ A     Alimenta~ A01   STOMATOL~   14775 55020\n 4 1991 Oct Concessional Co-pay~ A     Alimenta~ A01   STOMATOL~   15380 57222\n 5 1991 Nov Concessional Co-pay~ A     Alimenta~ A01   STOMATOL~   14371 52120\n 6 1991 Dec Concessional Co-pay~ A     Alimenta~ A01   STOMATOL~   15028 54299\n 7 1992 Jan Concessional Co-pay~ A     Alimenta~ A01   STOMATOL~   11040 39753\n 8 1992 Feb Concessional Co-pay~ A     Alimenta~ A01   STOMATOL~   15165 54405\n 9 1992 Mar Concessional Co-pay~ A     Alimenta~ A01   STOMATOL~   16898 61108\n10 1992 Apr Concessional Co-pay~ A     Alimenta~ A01   STOMATOL~   18141 65356\n# i 67,586 more rows\n```\n:::\n:::\n\n\n## Working with `tsibble` objects {-}\n\\fontsize{12}{14}\\sf\n\nWe can use the `filter()` function to select rows.\n\n\\fontsize{8}{10}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/pbs2_f6a8f661cf639080fee7c7a2345f5789'}\n\n```{.r .cell-code}\nPBS |>\n  filter(ATC2 == \"A10\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tsibble: 816 x 9 [1M]\n# Key:       Concession, Type, ATC1, ATC2 [4]\n      Month Concession   Type   ATC1  ATC1_desc ATC2  ATC2_desc Scripts   Cost\n      <mth> <chr>        <chr>  <chr> <chr>     <chr> <chr>       <dbl>  <dbl>\n 1 1991 Jul Concessional Co-pa~ A     Alimenta~ A10   ANTIDIAB~   89733 2.09e6\n 2 1991 Aug Concessional Co-pa~ A     Alimenta~ A10   ANTIDIAB~   77101 1.80e6\n 3 1991 Sep Concessional Co-pa~ A     Alimenta~ A10   ANTIDIAB~   76255 1.78e6\n 4 1991 Oct Concessional Co-pa~ A     Alimenta~ A10   ANTIDIAB~   78681 1.85e6\n 5 1991 Nov Concessional Co-pa~ A     Alimenta~ A10   ANTIDIAB~   70554 1.69e6\n 6 1991 Dec Concessional Co-pa~ A     Alimenta~ A10   ANTIDIAB~   75814 1.84e6\n 7 1992 Jan Concessional Co-pa~ A     Alimenta~ A10   ANTIDIAB~   64186 1.56e6\n 8 1992 Feb Concessional Co-pa~ A     Alimenta~ A10   ANTIDIAB~   75899 1.73e6\n 9 1992 Mar Concessional Co-pa~ A     Alimenta~ A10   ANTIDIAB~   89445 2.05e6\n10 1992 Apr Concessional Co-pa~ A     Alimenta~ A10   ANTIDIAB~   97315 2.23e6\n# i 806 more rows\n```\n:::\n:::\n\n\n## Working with `tsibble` objects {-}\n\\fontsize{12}{14}\\sf\n\nWe can use the `select()` function to select columns.\n\n\\fontsize{8}{10}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/pbs3_8be03fb1f68a8a715f29c962777a33bd'}\n\n```{.r .cell-code}\nPBS |>\n  filter(ATC2 == \"A10\") |>\n  select(Month, Concession, Type, Cost)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tsibble: 816 x 4 [1M]\n# Key:       Concession, Type [4]\n      Month Concession   Type           Cost\n      <mth> <chr>        <chr>         <dbl>\n 1 1991 Jul Concessional Co-payments 2092878\n 2 1991 Aug Concessional Co-payments 1795733\n 3 1991 Sep Concessional Co-payments 1777231\n 4 1991 Oct Concessional Co-payments 1848507\n 5 1991 Nov Concessional Co-payments 1686458\n 6 1991 Dec Concessional Co-payments 1843079\n 7 1992 Jan Concessional Co-payments 1564702\n 8 1992 Feb Concessional Co-payments 1732508\n 9 1992 Mar Concessional Co-payments 2046102\n10 1992 Apr Concessional Co-payments 2225977\n# i 806 more rows\n```\n:::\n:::\n\n\n## Working with `tsibble` objects {-}\n\\fontsize{12}{14}\\sf\n\nWe can use the `summarise()` function to summarise over keys.\n\n\\fontsize{8}{10}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/pbs4_eb35d719c98c8be4f9f46a951fac3441'}\n\n```{.r .cell-code}\nPBS |>\n  filter(ATC2 == \"A10\") |>\n  select(Month, Concession, Type, Cost) |>\n  summarise(total_cost = sum(Cost))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tsibble: 204 x 2 [1M]\n      Month total_cost\n      <mth>      <dbl>\n 1 1991 Jul    3526591\n 2 1991 Aug    3180891\n 3 1991 Sep    3252221\n 4 1991 Oct    3611003\n 5 1991 Nov    3565869\n 6 1991 Dec    4306371\n 7 1992 Jan    5088335\n 8 1992 Feb    2814520\n 9 1992 Mar    2985811\n10 1992 Apr    3204780\n# i 194 more rows\n```\n:::\n:::\n\n\n## Working with `tsibble` objects {-}\n\\fontsize{12}{14}\\sf\n\nWe can use the `mutate()` function to create new variables.\n\n\\fontsize{8}{10}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/pbs5_b2387a29f105662a3730c46b1ed28e9a'}\n\n```{.r .cell-code}\nPBS |>\n  filter(ATC2 == \"A10\") |>\n  select(Month, Concession, Type, Cost) |>\n  summarise(total_cost = sum(Cost)) |>\n  mutate(total_cost = total_cost / 1e6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tsibble: 204 x 2 [1M]\n      Month total_cost\n      <mth>      <dbl>\n 1 1991 Jul       3.53\n 2 1991 Aug       3.18\n 3 1991 Sep       3.25\n 4 1991 Oct       3.61\n 5 1991 Nov       3.57\n 6 1991 Dec       4.31\n 7 1992 Jan       5.09\n 8 1992 Feb       2.81\n 9 1992 Mar       2.99\n10 1992 Apr       3.20\n# i 194 more rows\n```\n:::\n:::\n\n\n## Working with `tsibble` objects {-}\n\\fontsize{12}{14}\\sf\n\nWe can use the `mutate()` function to create new variables.\n\n\\fontsize{8}{10}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/pbs6_a5ed14b67634f2af57370ea358369802'}\n\n```{.r .cell-code}\nPBS |>\n  filter(ATC2 == \"A10\") |>\n  select(Month, Concession, Type, Cost) |>\n  summarise(total_cost = sum(Cost)) |>\n  mutate(total_cost = total_cost / 1e6) -> a10\n```\n:::\n\n::: {.cell hash='1-tsibbles_cache/beamer/a10_c2de36e2bdea56c616e3317e39cd2745'}\n::: {.cell-output .cell-output-stdout}\n```\n# A tsibble: 204 x 2 [1M]\n      Month total_cost\n      <mth>      <dbl>\n 1 1991 Jul       3.53\n 2 1991 Aug       3.18\n 3 1991 Sep       3.25\n 4 1991 Oct       3.61\n 5 1991 Nov       3.57\n 6 1991 Dec       4.31\n 7 1992 Jan       5.09\n 8 1992 Feb       2.81\n 9 1992 Mar       2.99\n10 1992 Apr       3.20\n# i 194 more rows\n```\n:::\n:::\n\n\n\n\n# Lab Session 1\n\n## Lab Session 1\n\\fontsize{14}{15}\\sf\n\n 1. Download [`tourism.xlsx`](http://robjhyndman.com/data/tourism.xlsx) from [`http://robjhyndman.com/data/tourism.xlsx`](http://robjhyndman.com/data/tourism.xlsx), and read it into R using `read_excel()` from the `readxl` package.\n 2. Create a tsibble which is identical to the `tourism` tsibble from the `tsibble` package.\n 3. Find what combination of `Region` and `Purpose` had the maximum number of overnight trips on average.\n 4. Create a new tsibble which combines the Purposes and Regions, and just has total trips by State.\n\n# Time plots\n## Time plots\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/maxtemp_7901250a5d69a8901c21ec4c0e2a5ea5'}\n\n```{.r .cell-code}\nmaxtemp <- vic_elec |>\n  index_by(Day = date(Time)) |>\n  summarise(Temperature = max(Temperature))\nmaxtemp |>\n  autoplot(Temperature) +\n  labs(y = \"Max temperature\")\n```\n\n::: {.cell-output-display}\n![](1-tsibbles_files/figure-beamer/maxtemp-1.pdf)\n:::\n:::\n\n\n## Ansett airlines\n\n\\full{ansettlogo}\n\n## Ansett airlines\n\\fontsize{11}{12}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/unnamed-chunk-4_1f464568401a21f0873de08c7c1bfc35'}\n\n```{.r .cell-code}\nansett |>\n  autoplot(Passengers)\n```\n\n::: {.cell-output-display}\n![](1-tsibbles_files/figure-beamer/unnamed-chunk-4-1.pdf)\n:::\n:::\n\n\n## Ansett airlines\n\\fontsize{11}{12}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/unnamed-chunk-5_8eb638a9c74c9634dc17b9d0cc458dff'}\n\n```{.r .cell-code}\nansett |>\n  filter(Class == \"Economy\") |>\n  autoplot(Passengers)\n```\n\n::: {.cell-output-display}\n![](1-tsibbles_files/figure-beamer/unnamed-chunk-5-1.pdf)\n:::\n:::\n\n\n## Ansett airlines\n\\fontsize{11}{12}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/unnamed-chunk-6_3800aea2dcc4783f0e75cf0623c94299'}\n\n```{.r .cell-code}\nansett |>\n  filter(Airports == \"MEL-SYD\") |>\n  autoplot(Passengers)\n```\n\n::: {.cell-output-display}\n![](1-tsibbles_files/figure-beamer/unnamed-chunk-6-1.pdf)\n:::\n:::\n\n\n## Ansett airlines\n\\fontsize{11}{12}\\sf\n\n\n::: {.cell hash='1-tsibbles_cache/beamer/unnamed-chunk-7_31b4ee33e71f69fda79103f03f29132c'}\n\n```{.r .cell-code}\nansett |>\n  filter(Airports == \"MEL-SYD\") |>\n  autoplot(Passengers)\n```\n\n::: {.cell-output-display}\n![](1-tsibbles_files/figure-beamer/unnamed-chunk-7-1.pdf)\n:::\n:::\n\n\n\\begin{textblock}{2.5}(12.6,7.3)\n\\begin{alertblock}{}\nNot the real data! Or is it?\n\\end{alertblock}\n\\end{textblock}\n\n# Lab Session 2\n## Lab Session 2\n\n- Create time plots of the following four time series: `Bricks` from `aus_production`, `Lynx` from `pelt`, `Close` from `gafa_stock`, `Demand` from `vic_elec`.\n- Use `help()` to find out about the data in each series.\n- For the last plot, modify the axis labels and title.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}